const urlAPIDistante="https://tumbler/StuartGame/api/",LIST_METHOD=["GET","POST"],DEFAULT_RESPONSE="Erreur lors de l'appel de l'API";var xhrPool=[];window.onbeforeunload=function(){abortAllRequest()},window.abortAllRequest=function(){xhrPool.forEach(e=>{e.abort()}),xhrPool.length=0},window.modules={callAPI:function(e,t,n=null,l=null,s=null,r=null,o=null,a=null,i=!0){function c(e){var t=[];for(var n in e)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")}if(!LIST_METHOD.includes(e))throw"Méthode inconnue. Méthode autorisé : "+LIST_METHOD.toString();{let u=new XMLHttpRequest;xhrPool.push(u),u.onreadystatechange=function(){if(4==this.readyState){if(200==this.status){var e=JSON.parse(this.responseText);"no"==e.error?s?s(e):displayAlert("main","success","Appel Réussi"):r?r(e):displayAlert("main","warning",e.error)}else o?o():displayAlert("main","danger","Erreur lors de l'appel de l'API");a&&a()}},u.open(e,t+(null!=n&&"GET"==e?"?"+(n instanceof FormData?new URLSearchParams(n).toString():c(n)):""),i),null!=l&&u.setRequestHeader("Authorization","Bearer "+l),u.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),u.send(null!=n&&"POST"==e?n instanceof FormData?new URLSearchParams(n).toString():c(n):"")}},displayAlert:function(e,t,n){const l={info:{className:"alert-info",icon:"bi-info-circle"},success:{className:"alert-success",icon:"bi-patch-check"},warning:{className:"alert-warning",icon:"bi-exclamation-triangle"},danger:{className:"alert-danger",icon:"bi-x-octagon"}};if(null==document.querySelector(e))throw"Element absence de la page";{document.querySelectorAll(e+" div.alert").forEach(e=>{e.remove()});let s=document.createElement("div");s.classList.add("alert","alert-dismissible","fade","show",l[t].className),s.innerHTML='<i class="bi '+l[t].icon+'"></i> '+n+'<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button></div>',document.querySelector(e).prepend(s)}},cookie:{set:function(e,t,n){let l=new Date;l.setTime(l.getTime()+24*n*60*60*1e3);let s="expires="+l.toUTCString();document.cookie=e+"="+t+";"+s+";path=/",console.log("cookie set")},get:function(e){let t=e+"=",n=document.cookie.split(";");for(let e=0;e<n.length;e++){let l=n[e];for(;" "==l.charAt(0);)l=l.substring(1);if(0==l.indexOf(t))return l.substring(t.length,l.length)}return""},delete:function(e){this.get(e)&&(document.cookie=e+"=;path=/;expires=Thu, 01 Jan 1970 00:00:01 GMT")}},search:{table:function(e,t,n="",l="LIKE"){if("string"==typeof e){let s=document.getElementById(e),r=s.querySelector("tbody").rows;for(let e of r)switch(l){case"LIKE":e.querySelectorAll("td")[t].innerHTML.includes(n)?e.classList.contains("mustBeMask")||e.classList.remove("d-none"):e.classList.add("d-none");break;case"EQUAL":e.querySelectorAll("td")[t].innerHTML==n?e.classList.contains("mustBeMask")||e.classList.remove("d-none"):e.classList.add("d-none")}}},array:function(e,t,n="",l="LIKE"){let s=[];return"object"==typeof e&&e.length>0&&e.forEach(e=>{if(e[t])switch(l){case"LIKE":e[t].includes(n)&&s.push(e);break;case"EQUAL":e[t]==n&&s.push(e)}else s=[]}),s}},sort:{table:function(e,t){let n,l,s,r,o,a,i,c=0;for(t=document.getElementById(t),l=!0,o="asc";l;)if(l=!1,n=t.querySelector("tbody").rows,n.length){for(s=0;s<n.length-1;s++)if(r=!1,a=n[s].querySelectorAll("td")[e].innerHTML,i=n[s+1].querySelectorAll("td")[e].innerHTML,a=isNaN(a)?a.includes("%")||a.includes("€")?parseFloat(a.split(/( )|(&nbsp;)/)[0]):a:parseFloat(a),i=isNaN(i)?i.includes("%")||i.includes("€")?parseFloat(i.split(/( )|(&nbsp;)/)[0]):i:parseFloat(i),"asc"==o){if(a>i){r=!0;break}}else if(a<i){r=!0;break}r?(n[s].parentNode.insertBefore(n[s+1],n[s]),l=!0,c++):0==c&&"asc"==o&&(o="desc",l=!0)}}},loadBtn:function(e,t,n,l,s=null){if(null===e)throw"Erreur Selector";l=["grow","border"].includes(l)?l:"border",s=null!=s?["sm","lg"].includes(s)?s:"sm":null,e.innerHTML=e.disabled?null==t?"OK":t:'<span class="spinner-'+l+(null!=s?" spinner-"+l+"-"+s:"")+'" role="status" aria-hidden="true"></span>'+(!0!==n?" "+(null==t?"Chargement...":t):""),e.disabled=!e.disabled}};